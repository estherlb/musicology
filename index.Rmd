---
title: "Music and movies"
author: "Esther Bakels"
date: "9-2-2021"
output: html_document
---

```{r}
library(tidyverse)
library(spotifyr)
```

```{r}
CM_themes <- get_playlist_audio_features("","6ubQSyY5AOAZOTLaBUFHWD")
CM_soundtrack <- get_playlist_audio_features("","5Lo1O7pS5PWc9z6UuplHyX")
CM_faves <- get_playlist_audio_features("","0QzlUG13KFnSFOqgxeEli2")
```

```{r}
songs <-
  bind_rows(
    CM_themes %>% mutate(category = "B. Theme songs"),
    CM_faves %>% mutate(category = "A. My songs"),
    CM_soundtrack %>% mutate(category = "C. more soundtracks")
  )
```

```{r}
songs %>%
  ggplot(aes(x = category, y = valence)) +
  geom_boxplot()
```

```{r}
songs %>%
  ggplot(aes(x = category, y = tempo)) +
  geom_boxplot()
```
```{r}
songs %>%
  ggplot(aes(x = category, y = danceability)) +
  geom_boxplot()
```
```{r}
songs %>%
  ggplot(aes(x = category, y = energy)) +
  geom_violin()
```



```{r}
ggplot(songs, aes(valence, danceability, colour = category, size = track.popularity)) + 
  geom_point()
```

```{r}
ggplot(songs, aes(energy, tempo, colour = category, size = track.popularity)) + 
  geom_point()
```

```{r}
my_songs_mean <- CM_faves %>%
  summarise(
    mean_tempo = mean(tempo)
  )
my_songs_mean
```
```{r}
# Print which theme song is closest to mean tempo of my songs
Themes_tempo <- CM_themes[,"tempo"]
Values <- abs(Themes_tempo-c(my_songs_mean))
Min_value = min(Values)
Index <- which(Values==Min_value)
CM_themes[Index, "track.name"]
```




